---
name: mooc-quiz-auto-processing
description: "适用于在线学习平台（如超星）的自动化答题技能，包含多层Iframe穿透、防字符混淆定位及提交前状态强校验。"
---

### 1. 多层 Iframe 穿透定位
- **识别结构**：在线课程答题区通常嵌套在 3 层及以上的 iframe 中（如 `index` -> `cards` -> `work` -> `doHomeWorkNew`）。
- **操作规范**：必须使用 `evaluate_script` 编写递归查询函数或逐级查找 `contentDocument`，确保所有的 DOM 操作和元素查询都在最内层的答题文档中执行。

### 2. 元素语义对齐（防字符混淆）
- **规避干扰**：针对页面开启的字符混淆（Font-obfuscation），禁止通过纯文本匹配（如 `innerText`）来定位题目或选项。
- **定位策略**：利用选项的 Class 特征（如 `num_option_dx`、`answer_option`）、DOM 相对位置关系或 `data-` 属性进行锚定。

### 3. “点击-验证”闭环流程（核心防止漏选）
- **执行点击**：调用 DOM 元素的 `click()` 方法，并触发必要的 `change` 或 `mousedown/mouseup` 事件以模拟真实交互。
- **状态验算**：**严禁在点击后直接提交**。点击后必须再次运行查询脚本，检查目标元素是否已获得 `check_answer`、`choiced`、`selected` 等表示选中的 Class 样式或属性。
- **视觉确认**：在提交前，调用 `take_screenshot` 对答题关键区域进行截图存档，以便在出现异常时（如 0 分）溯源。

### 4. 逻辑答题准则
- **离线决策**：在不使用联网搜索的情况下，基于上下文语义和常识（如劳动精神、通用价值观）进行逻辑判断。
- **提交策略**：只有当所有题目都通过“状态验算”确认为选中状态后，方可触发 `提交` 按钮，并处理随后的 `alert` 或 `confirm` 二次确认弹窗。

### 5. 进度与账目管理
- **任务记录**：每完成一节，必须更新任务清单（如使用 `TodoWrite`），记录得分情况。若发现 Iframe 穿透失败或提交异常，立即标记为 `warning` 或 `failed` 并停下来向用户报告，禁止盲目继续。
